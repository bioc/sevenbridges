<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="sevenbridges">
<title>Creating Your Docker Container and Command Line Interface (with docopt) • sevenbridges</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Creating Your Docker Container and Command Line Interface (with docopt)">
<meta property="og:description" content="sevenbridges">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">sevenbridges</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.19.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/api.html">Complete Guide for Seven Bridges API R Client</a>
    <a class="dropdown-item" href="../articles/apps.html">Describe and Execute CWL Tools/Workflows in R</a>
    <a class="dropdown-item" href="../articles/bioc-workflow.html">Master Tutorial: Use R for Cancer Genomics Cloud</a>
    <a class="dropdown-item" href="../articles/cgc-datasets.html">Find Data on CGC via Data Browser and Datasets API</a>
    <a class="dropdown-item" href="../articles/docker.html">Creating Your Docker Container and Command Line Interface (with docopt)</a>
    <a class="dropdown-item" href="../articles/rstudio.html">IDE Container: RStudio Server, Shiny Server, and More</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/sbg/sevenbridges-r/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Creating Your Docker Container and Command Line Interface (with docopt)</h1>
            
            <h4 data-toc-skip class="date">2023-04-05</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/sbg/sevenbridges-r/blob/HEAD/vignettes/docker.Rmd" class="external-link"><code>vignettes/docker.Rmd</code></a></small>
      <div class="d-none name"><code>docker.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p><strong>In progress</strong></p>
<p>In this tutorial, we will go through ways to</p>
<ul>
<li>Make native command line interface in R</li>
</ul>
<p>There are many fun ways to do it, here I am more focused for R
developers.</p>
<div class="section level3">
<h3 id="existing-docker-repos">Existing Docker repos<a class="anchor" aria-label="anchor" href="#existing-docker-repos"></a>
</h3>
<p>Before you create any, make sure you don’t re-invent the wheel and
use the best base image for your container as your tool chain may save
your lots of time later on.</p>
<div class="section level4">
<h4 id="rocker-project">Rocker Project<a class="anchor" aria-label="anchor" href="#rocker-project"></a>
</h4>
<p>Official R Docker images is called “Rocker”” project and is on <a href="https://github.com/rocker-org/rocker" class="external-link">GitHub</a>, please visit the
page to find more details and Dockerfile.</p>
<table class="table">
<thead><tr class="header">
<th>Image</th>
<th align="center">Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>rocker/r-base</code></td>
<td align="center">base package to build from</td>
</tr>
<tr class="even">
<td><code>rocker/r-devel</code></td>
<td align="center">base + R-devel from SVN</td>
</tr>
<tr class="odd">
<td><code>rocker/rstudio</code></td>
<td align="center">base + RStudio Server</td>
</tr>
<tr class="even">
<td><code>rocker/hadleyverse</code></td>
<td align="center">rstudio + Hadley’s packages, LaTeX</td>
</tr>
<tr class="odd">
<td><code>rocker/ropensci</code></td>
<td align="center">hadleyverse + rOpenSci packages</td>
</tr>
<tr class="even">
<td><code>rocker/r-devel-san</code></td>
<td align="center">base, SVN’s R-devel and SAN</td>
</tr>
</tbody>
</table>
</div>
<div class="section level4">
<h4 id="bioconductor-images">Bioconductor Images<a class="anchor" aria-label="anchor" href="#bioconductor-images"></a>
</h4>
<p>Bioconductor have a nice <a href="https://bioconductor.org/help/docker/" class="external-link">page</a> about the official
Docker images, please read for more details.</p>
<table class="table">
<colgroup>
<col width="50%">
<col width="50%">
</colgroup>
<thead><tr class="header">
<th>Image (release branch)</th>
<th>Image (development branch)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>bioconductor/release_base</code></td>
<td><code>bioconductor/devel_base</code></td>
</tr>
<tr class="even">
<td><code>bioconductor/release_core</code></td>
<td><code>bioconductor/devel_core</code></td>
</tr>
<tr class="odd">
<td><code>bioconductor/release_flow</code></td>
<td><code>bioconductor/devel_flow</code></td>
</tr>
<tr class="even">
<td><code>bioconductor/release_microarray</code></td>
<td><code>bioconductor/devel_microarray</code></td>
</tr>
<tr class="odd">
<td><code>bioconductor/release_proteomics</code></td>
<td><code>bioconductor/devel_proteomics</code></td>
</tr>
<tr class="even">
<td><code>bioconductor/release_sequencing</code></td>
<td><code>bioconductor/devel_sequencing</code></td>
</tr>
<tr class="odd">
<td><code>bioconductor/release_metabolomics</code></td>
<td><code>bioconductor/devel_metabolomics</code></td>
</tr>
</tbody>
</table>
<p>To understand the image quickly here is the short instruction for the
image name:</p>
<ul>
<li><p><strong>release</strong> images are based on
<code>rocker/rstudio</code></p></li>
<li><p><strong>devel</strong> images are based on
<code>rocker/rstudio-daily</code></p></li>
<li><p><strong>base</strong>: Contains R, RStudio, and system
dependencies.</p></li>
<li><p><strong>core</strong>: base + a selection of core
packages.</p></li>
<li><p><strong>flow</strong>: core + all packages tagged with the
<em>FlowCytometry</em> biocView.</p></li>
<li><p><strong>microarray</strong>: core + all packages tagged with the
<em>Microarray</em> biocView.</p></li>
<li><p><strong>proteomics</strong>: core + all packages tagged with the
<em>Proteomics</em> biocView.</p></li>
<li><p><strong>sequencing</strong>: core + all packages tagged with the
<em>Sequencing</em> biocView.</p></li>
<li><p><strong>metabolomics</strong>: core + all packages tagged with
the <em>Metabolomics</em> biocView.</p></li>
</ul>
</div>
<div class="section level4">
<h4 id="docker-hub">Docker Hub<a class="anchor" aria-label="anchor" href="#docker-hub"></a>
</h4>
<p><a href="https://hub.docker.com" class="external-link">Docker Hub</a> also provide
public/private repos, you can search existing tools without building
yourself, it’s very likely some popular tool already have Docker
container well maintained there.</p>
</div>
<div class="section level4">
<h4 id="seven-bridges-docker-registry">Seven Bridges Docker Registry<a class="anchor" aria-label="anchor" href="#seven-bridges-docker-registry"></a>
</h4>
<p>Tutorial coming soon.</p>
<p>Example Seven Bridges registry:</p>
<ul>
<li>
<strong>SevenBridges</strong> :
<code>images.sbgenomics.com/&lt;repository&gt;[:&lt;tag&gt;]</code>
</li>
<li>
<strong>Cancer Genomics Cloud</strong>:
<code>cgc-images.sbgenomics.com/&lt;repository&gt;[:&lt;tag&gt;]</code>
</li>
</ul>
</div>
</div>
</div>
<div class="section level2">
<h2 id="tutorial-random-number-generator">Tutorial: Random Number Generator<a class="anchor" aria-label="anchor" href="#tutorial-random-number-generator"></a>
</h2>
<p>Our goal here is to making a CWL app to generate uniform random
numbers, yes, the core function is <code><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif()</a></code>, it’s a native
function in R.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dput.html" class="external-link">dput</a></span><span class="op">(</span><span class="va">runif</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## function (n, min = 0, max = 1) </span></span>
<span><span class="co">## .Call(C_runif, n, min, max)</span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1001</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] 0.985688783 0.412628483 0.429539246 0.419172236 0.426506559 0.887797565</span></span>
<span><span class="co">##  [7] 0.006096034 0.081215761 0.288657362 0.765342145</span></span></code></pre>
<div class="section level3">
<h3 id="using-docopt-package">Using <code>docopt</code> Package<a class="anchor" aria-label="anchor" href="#using-docopt-package"></a>
</h3>
<p>In R, we also have a nice implementation in a package called
<code>docopt</code>, developed by <em>Edwin de Jonge</em>. Check out its
<a href="https://github.com/docopt/docopt.R" class="external-link">tutorial</a> on GitHub.</p>
<p>So let’s quickly create a command line interface for our R scripts
with a dummy example. Let’s turn the uniform distribution function
<code>runif</code> into a command line tool.</p>
<p>when you check out the help page for <code>runif</code>, here is the
key information you want to markdown.</p>
<pre><code>Usage

runif(n, min = 0, max = 1)

Arguments

n
number of observations. If length(n) &gt; 1, the length is taken to be the number required.

min, max
lower and upper limits of the distribution. Must be finite.</code></pre>
<p>I will add one more parameter to set seed, here is the R script file
called <code>runif.R</code>.</p>
<p>At the beginning of the command line script, I use the docopt
standard to write my tool help.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="st">"usage: runif.R [--n=&lt;int&gt; --min=&lt;float&gt; --max=&lt;float&gt; --seed=&lt;float&gt;]\n\noptions:\n --n=&lt;int&gt;        number of observations. If length(n) &gt; 1, the length is taken to be the number required [default: 1].\n --min=&lt;float&gt;   lower limits of the distribution. Must be finite [default: 0].\n --max=&lt;float&gt;   upper limits of the distribution. Must be finite [default: 1].\n --seed=&lt;float&gt;  seed for set.seed() function [default: 1]"</span> <span class="op">-&gt;</span> <span class="va">doc</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/docopt/docopt.R" class="external-link">"docopt"</a></span><span class="op">)</span></span></code></pre></div>
<p>Let’s first do some testing in your R session before you make it a
full functional command line tool.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/docopt/man/docopt.html" class="external-link">docopt</a></span><span class="op">(</span><span class="va">doc</span><span class="op">)</span> <span class="co"># with no argumetns provided</span></span></code></pre></div>
<pre><code><span><span class="co">## List of 8</span></span>
<span><span class="co">##  $ --n   : chr "1"</span></span>
<span><span class="co">##  $ --min : chr "0"</span></span>
<span><span class="co">##  $ --max : chr "1"</span></span>
<span><span class="co">##  $ --seed: chr "1"</span></span>
<span><span class="co">##  $ n     : chr "1"</span></span>
<span><span class="co">##  $ min   : chr "0"</span></span>
<span><span class="co">##  $ max   : chr "1"</span></span>
<span><span class="co">##  $ seed  : chr "1"</span></span>
<span><span class="co">## NULL</span></span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/docopt/man/docopt.html" class="external-link">docopt</a></span><span class="op">(</span><span class="va">doc</span>, <span class="st">"--n 10 --min=3 --max=5"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## List of 8</span></span>
<span><span class="co">##  $ --n   : chr "10"</span></span>
<span><span class="co">##  $ --min : chr "3"</span></span>
<span><span class="co">##  $ --max : chr "5"</span></span>
<span><span class="co">##  $ --seed: chr "1"</span></span>
<span><span class="co">##  $ n     : chr "10"</span></span>
<span><span class="co">##  $ min   : chr "3"</span></span>
<span><span class="co">##  $ max   : chr "5"</span></span>
<span><span class="co">##  $ seed  : chr "1"</span></span>
<span><span class="co">## NULL</span></span></code></pre>
<p>Looks like it works, now let’s add main function script for this
command line tool.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">opts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/docopt/man/docopt.html" class="external-link">docopt</a></span><span class="op">(</span><span class="va">doc</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="va">opts</span><span class="op">$</span><span class="va">seed</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span></span>
<span>  n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">opts</span><span class="op">$</span><span class="va">n</span><span class="op">)</span>,</span>
<span>  min <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">opts</span><span class="op">$</span><span class="va">min</span><span class="op">)</span>,</span>
<span>  max <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">opts</span><span class="op">$</span><span class="va">max</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.2655087</span></span></code></pre>
<p>Add Shebang at the top of the file, this is a complete example for
<code>runif.R</code> command line will be like this</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#!/usr/bin/Rscript</span></span>
<span><span class="st">"usage: runif.R [--n=&lt;int&gt; --min=&lt;float&gt; --max=&lt;float&gt; --seed=&lt;float&gt;]\n\noptions:\n --n=&lt;int&gt;        number of observations. If length(n) &gt; 1, the length is taken to be the number required [default: 1].\n --min=&lt;float&gt;   lower limits of the distribution. Must be finite [default: 0].\n --max=&lt;float&gt;   upper limits of the distribution. Must be finite [default: 1].\n --seed=&lt;float&gt;  seed for set.seed() function [default: 1]"</span> <span class="op">-&gt;</span> <span class="va">doc</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/docopt/docopt.R" class="external-link">"docopt"</a></span><span class="op">)</span></span>
<span><span class="va">opts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/docopt/man/docopt.html" class="external-link">docopt</a></span><span class="op">(</span><span class="va">doc</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="va">opts</span><span class="op">$</span><span class="va">seed</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span></span>
<span>  n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">opts</span><span class="op">$</span><span class="va">n</span><span class="op">)</span>,</span>
<span>  min <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">opts</span><span class="op">$</span><span class="va">min</span><span class="op">)</span>,</span>
<span>  max <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">opts</span><span class="op">$</span><span class="va">max</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Let’s test this command line.</p>
<pre><code>$ runif.R --help
Loading required package: methods
usage: runif.R [--n=&lt;int&gt; --min=&lt;float&gt; --max=&lt;float&gt; --seed=&lt;float&gt;]

options:
 --n=&lt;int&gt;        number of observations. If length(n) &gt; 1, the length is taken to be the number required [default: 1].
 --min=&lt;float&gt;   lower limits of the distribution. Must be finite [default: 0].
 --max=&lt;float&gt;   upper limits of the distribution. Must be finite [default: 1].
 --seed=&lt;float&gt;  seed for set.seed() function [default: 1]
$ runif.R
Loading required package: methods
[1] 0.2655087
$ runif.R
Loading required package: methods
[1] 0.2655087
$ runif.R --seed=123 --n 10 --min=1 --max=100
Loading required package: methods
 [1] 29.470174 79.042208 41.488715 88.418723 94.106261  5.510093 53.282443
 [8] 89.349485 55.592066 46.204859</code></pre>
<p>For full example you can check my GitHub <a href="https://github.com/tengfei/docker/tree/master/runif" class="external-link">example</a>.</p>
</div>
<div class="section level3">
<h3 id="quick-command-line-interface-with-commandargs-position-and-named-args">Quick Command Line Interface with <code>commandArgs</code> (Position
and Named Args)<a class="anchor" aria-label="anchor" href="#quick-command-line-interface-with-commandargs-position-and-named-args"></a>
</h3>
<p>For advanced users, please read another tutorial “Creating Your
Docker Container and Command Line Interface (with docopt)”, “docopt” is
more formal way to construct your command line interface, but there is a
quick way to make command line interface here using just
<code>commandArgs</code>.</p>
<p>Suppose I already have a R script like this using position mapping
the arguments</p>
<ol style="list-style-type: decimal">
<li><code>numbers</code></li>
<li><code>min</code></li>
<li><code>max</code></li>
</ol>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"docker/sevenbridges/src"</span>, <span class="st">"runif2spin.R"</span>, package <span class="op">=</span> <span class="st">"sevenbridges"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/readLines.html" class="external-link">readLines</a></span><span class="op">(</span><span class="va">fl</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">"\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#' ---</span></span>
<span><span class="co">#' title: "Uniform random number generator example"</span></span>
<span><span class="co">#' output:</span></span>
<span><span class="co">#'     html_document:</span></span>
<span><span class="co">#'     toc: true</span></span>
<span><span class="co">#' number_sections: true</span></span>
<span><span class="co">#' ---</span></span>
<span></span>
<span><span class="co">#' # summary report</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' This is a random number generator</span></span>
<span></span>
<span><span class="co">#+</span></span>
<span><span class="va">args</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/commandArgs.html" class="external-link">commandArgs</a></span><span class="op">(</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">r</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span>n   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">args</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span>
<span>          min <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">args</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,</span>
<span>          max <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">args</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span></span></code></pre>
<p>Ignore the comment part, I will introduce spin/stich later. My base
command will be something like</p>
<pre><code>Rscript runif2spin.R 10 30 50</code></pre>
<p>I just describe my tool in this way</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://www.sevenbridges.com" class="external-link">"sevenbridges"</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">fd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/requirements.html">fileDef</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"runif.R"</span>,</span>
<span>  content <span class="op">=</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_file.html" class="external-link">read_file</a></span><span class="op">(</span><span class="va">fl</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">rbx</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Tool-class.html">Tool</a></span><span class="op">(</span></span>
<span>  id <span class="op">=</span> <span class="st">"runif"</span>,</span>
<span>  label <span class="op">=</span> <span class="st">"runif"</span>,</span>
<span>  hints <span class="op">=</span> <span class="fu"><a href="../reference/requirements.html">requirements</a></span><span class="op">(</span><span class="fu"><a href="../reference/requirements.html">docker</a></span><span class="op">(</span>pull <span class="op">=</span> <span class="st">"rocker/r-base"</span><span class="op">)</span>, <span class="fu"><a href="../reference/requirements.html">cpu</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="../reference/requirements.html">mem</a></span><span class="op">(</span><span class="fl">2000</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  requirements <span class="op">=</span> <span class="fu"><a href="../reference/requirements.html">requirements</a></span><span class="op">(</span><span class="va">fd</span><span class="op">)</span>,</span>
<span>  baseCommand <span class="op">=</span> <span class="st">"Rscript runif.R"</span>,</span>
<span>  stdout <span class="op">=</span> <span class="st">"output.txt"</span>,</span>
<span>  inputs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/shorthand-cwl.html">input</a></span><span class="op">(</span></span>
<span>      id <span class="op">=</span> <span class="st">"number"</span>,</span>
<span>      type <span class="op">=</span> <span class="st">"integer"</span>,</span>
<span>      position <span class="op">=</span> <span class="fl">1</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/shorthand-cwl.html">input</a></span><span class="op">(</span></span>
<span>      id <span class="op">=</span> <span class="st">"min"</span>,</span>
<span>      type <span class="op">=</span> <span class="st">"float"</span>,</span>
<span>      position <span class="op">=</span> <span class="fl">2</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/shorthand-cwl.html">input</a></span><span class="op">(</span></span>
<span>      id <span class="op">=</span> <span class="st">"max"</span>,</span>
<span>      type <span class="op">=</span> <span class="st">"float"</span>,</span>
<span>      position <span class="op">=</span> <span class="fl">3</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  outputs <span class="op">=</span> <span class="fu"><a href="../reference/shorthand-cwl.html">output</a></span><span class="op">(</span>id <span class="op">=</span> <span class="st">"random"</span>, glob <span class="op">=</span> <span class="st">"output.txt"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Now copy-paste the JSON into your project app and run it in the cloud
to test it</p>
<p>How about named arguments? I will still recommend use “docopt”
package, but for simple way.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"docker/sevenbridges/src"</span>, <span class="st">"runif_args.R"</span>, package <span class="op">=</span> <span class="st">"sevenbridges"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/readLines.html" class="external-link">readLines</a></span><span class="op">(</span><span class="va">fl</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">"\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#' ---</span></span>
<span><span class="co">#' title: "Uniform random number generator example"</span></span>
<span><span class="co">#' output:</span></span>
<span><span class="co">#'     html_document:</span></span>
<span><span class="co">#'     toc: true</span></span>
<span><span class="co">#' number_sections: true</span></span>
<span><span class="co">#' ---</span></span>
<span></span>
<span><span class="co">#' # summary report</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' This is a random number generator</span></span>
<span></span>
<span><span class="co">#+</span></span>
<span><span class="va">args</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/commandArgs.html" class="external-link">commandArgs</a></span><span class="op">(</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## quick hack to split named arguments</span></span>
<span><span class="va">splitArgs</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">x</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span><span class="op">{</span></span>
<span>        <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span><span class="va">i</span>, <span class="st">"="</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span>        <span class="va">nm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"-+"</span>, <span class="st">""</span>,<span class="va">res</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">nm</span>, <span class="va">res</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">.r</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">.r</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span></span>
<span>    <span class="va">.r</span></span>
<span><span class="op">}</span></span>
<span><span class="va">args</span> <span class="op">&lt;-</span> <span class="fu">splitArgs</span><span class="op">(</span><span class="va">args</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#+</span></span>
<span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span>n   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">args</span><span class="op">[</span><span class="st">"n"</span><span class="op">]</span><span class="op">)</span>,</span>
<span>           min <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">args</span><span class="op">[</span><span class="st">"min"</span><span class="op">]</span><span class="op">)</span>,</span>
<span>           max <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">args</span><span class="op">[</span><span class="st">"max"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="va">r</span>, file <span class="op">=</span> <span class="st">"out.csv"</span><span class="op">)</span></span></code></pre>
<pre><code>Rscript runif_args.R --n=10 --min=30 --max=50</code></pre>
<p>I just describe my tool in this way, note, I use
<code>separate=FALSE</code> and add <code>=</code> to my prefix as a
hack.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/requirements.html">fileDef</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"runif.R"</span>,</span>
<span>  content <span class="op">=</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_file.html" class="external-link">read_file</a></span><span class="op">(</span><span class="va">fl</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">rbx</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Tool-class.html">Tool</a></span><span class="op">(</span></span>
<span>  id <span class="op">=</span> <span class="st">"runif"</span>,</span>
<span>  label <span class="op">=</span> <span class="st">"runif"</span>,</span>
<span>  hints <span class="op">=</span> <span class="fu"><a href="../reference/requirements.html">requirements</a></span><span class="op">(</span><span class="fu"><a href="../reference/requirements.html">docker</a></span><span class="op">(</span>pull <span class="op">=</span> <span class="st">"rocker/r-base"</span><span class="op">)</span>, <span class="fu"><a href="../reference/requirements.html">cpu</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="../reference/requirements.html">mem</a></span><span class="op">(</span><span class="fl">2000</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  requirements <span class="op">=</span> <span class="fu"><a href="../reference/requirements.html">requirements</a></span><span class="op">(</span><span class="va">fd</span><span class="op">)</span>,</span>
<span>  baseCommand <span class="op">=</span> <span class="st">"Rscript runif.R"</span>,</span>
<span>  stdout <span class="op">=</span> <span class="st">"output.txt"</span>,</span>
<span>  inputs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/shorthand-cwl.html">input</a></span><span class="op">(</span></span>
<span>      id <span class="op">=</span> <span class="st">"number"</span>,</span>
<span>      type <span class="op">=</span> <span class="st">"integer"</span>,</span>
<span>      separate <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>      prefix <span class="op">=</span> <span class="st">"--n="</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/shorthand-cwl.html">input</a></span><span class="op">(</span></span>
<span>      id <span class="op">=</span> <span class="st">"min"</span>,</span>
<span>      type <span class="op">=</span> <span class="st">"float"</span>,</span>
<span>      separate <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>      prefix <span class="op">=</span> <span class="st">"--min="</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/shorthand-cwl.html">input</a></span><span class="op">(</span></span>
<span>      id <span class="op">=</span> <span class="st">"max"</span>,</span>
<span>      type <span class="op">=</span> <span class="st">"float"</span>,</span>
<span>      separate <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>      prefix <span class="op">=</span> <span class="st">"--max="</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  outputs <span class="op">=</span> <span class="fu"><a href="../reference/shorthand-cwl.html">output</a></span><span class="op">(</span>id <span class="op">=</span> <span class="st">"random"</span>, glob <span class="op">=</span> <span class="st">"output.txt"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="quick-report-spin-and-stich">Quick Report: Spin and Stich<a class="anchor" aria-label="anchor" href="#quick-report-spin-and-stich"></a>
</h3>
<p>Alternative, you can use spin/stich from knitr to generate report
directly from an R script with special format. For example, let’s use
the above example</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"docker/sevenbridges/src"</span>, <span class="st">"runif_args.R"</span>, package <span class="op">=</span> <span class="st">"sevenbridges"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/readLines.html" class="external-link">readLines</a></span><span class="op">(</span><span class="va">fl</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">"\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#' ---</span></span>
<span><span class="co">#' title: "Uniform random number generator example"</span></span>
<span><span class="co">#' output:</span></span>
<span><span class="co">#'     html_document:</span></span>
<span><span class="co">#'     toc: true</span></span>
<span><span class="co">#' number_sections: true</span></span>
<span><span class="co">#' ---</span></span>
<span></span>
<span><span class="co">#' # summary report</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' This is a random number generator</span></span>
<span></span>
<span><span class="co">#+</span></span>
<span><span class="va">args</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/commandArgs.html" class="external-link">commandArgs</a></span><span class="op">(</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## quick hack to split named arguments</span></span>
<span><span class="va">splitArgs</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">x</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span><span class="op">{</span></span>
<span>        <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span><span class="va">i</span>, <span class="st">"="</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span>        <span class="va">nm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"-+"</span>, <span class="st">""</span>,<span class="va">res</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">nm</span>, <span class="va">res</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">.r</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">.r</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span></span>
<span>    <span class="va">.r</span></span>
<span><span class="op">}</span></span>
<span><span class="va">args</span> <span class="op">&lt;-</span> <span class="fu">splitArgs</span><span class="op">(</span><span class="va">args</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#+</span></span>
<span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span>n   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">args</span><span class="op">[</span><span class="st">"n"</span><span class="op">]</span><span class="op">)</span>,</span>
<span>           min <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">args</span><span class="op">[</span><span class="st">"min"</span><span class="op">]</span><span class="op">)</span>,</span>
<span>           max <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">args</span><span class="op">[</span><span class="st">"max"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="va">r</span>, file <span class="op">=</span> <span class="st">"out.csv"</span><span class="op">)</span></span></code></pre>
<p>You command is something like this</p>
<pre><code>Rscript -e "rmarkdown::render(knitr::spin('runif_args.R', FALSE))" --args --n=100 --min=30 --max=50</code></pre>
<p>And so I describe my tool like this with Docker image
<code>rocker/hadleyverse</code> this contains knitr and rmarkdown
package.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/requirements.html">fileDef</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"runif.R"</span>,</span>
<span>  content <span class="op">=</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_file.html" class="external-link">read_file</a></span><span class="op">(</span><span class="va">fl</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">rbx</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Tool-class.html">Tool</a></span><span class="op">(</span></span>
<span>  id <span class="op">=</span> <span class="st">"runif"</span>,</span>
<span>  label <span class="op">=</span> <span class="st">"runif"</span>,</span>
<span>  hints <span class="op">=</span> <span class="fu"><a href="../reference/requirements.html">requirements</a></span><span class="op">(</span><span class="fu"><a href="../reference/requirements.html">docker</a></span><span class="op">(</span>pull <span class="op">=</span> <span class="st">"rocker/hadleyverse"</span><span class="op">)</span>, <span class="fu"><a href="../reference/requirements.html">cpu</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="../reference/requirements.html">mem</a></span><span class="op">(</span><span class="fl">2000</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  requirements <span class="op">=</span> <span class="fu"><a href="../reference/requirements.html">requirements</a></span><span class="op">(</span><span class="va">fd</span><span class="op">)</span>,</span>
<span>  baseCommand <span class="op">=</span> <span class="st">"Rscript -e \"rmarkdown::render(knitr::spin('runif.R', FALSE))\" --args"</span>,</span>
<span>  stdout <span class="op">=</span> <span class="st">"output.txt"</span>,</span>
<span>  inputs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/shorthand-cwl.html">input</a></span><span class="op">(</span></span>
<span>      id <span class="op">=</span> <span class="st">"number"</span>,</span>
<span>      type <span class="op">=</span> <span class="st">"integer"</span>,</span>
<span>      separate <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>      prefix <span class="op">=</span> <span class="st">"--n="</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/shorthand-cwl.html">input</a></span><span class="op">(</span></span>
<span>      id <span class="op">=</span> <span class="st">"min"</span>,</span>
<span>      type <span class="op">=</span> <span class="st">"float"</span>,</span>
<span>      separate <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>      prefix <span class="op">=</span> <span class="st">"--min="</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/shorthand-cwl.html">input</a></span><span class="op">(</span></span>
<span>      id <span class="op">=</span> <span class="st">"max"</span>,</span>
<span>      type <span class="op">=</span> <span class="st">"float"</span>,</span>
<span>      separate <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>      prefix <span class="op">=</span> <span class="st">"--max="</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  outputs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/shorthand-cwl.html">output</a></span><span class="op">(</span>id <span class="op">=</span> <span class="st">"stdout"</span>, type <span class="op">=</span> <span class="st">"file"</span>, glob <span class="op">=</span> <span class="st">"output.txt"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/shorthand-cwl.html">output</a></span><span class="op">(</span>id <span class="op">=</span> <span class="st">"random"</span>, type <span class="op">=</span> <span class="st">"file"</span>, glob <span class="op">=</span> <span class="st">"*.csv"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/shorthand-cwl.html">output</a></span><span class="op">(</span>id <span class="op">=</span> <span class="st">"report"</span>, type <span class="op">=</span> <span class="st">"file"</span>, glob <span class="op">=</span> <span class="st">"*.html"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>You will get a report in the end.</p>
</div>
<div class="section level3">
<h3 id="executable-report-with-r-markdown-advanced">Executable Report with R Markdown (Advanced)<a class="anchor" aria-label="anchor" href="#executable-report-with-r-markdown-advanced"></a>
</h3>
<p>We cannot really make a R Markdown file executable in it by simply
put</p>
<pre><code><span><span class="co">#!/bin/bash/Rscript</span></span></code></pre>
<p>In your markdown document.</p>
<p>Of course, we can figure out a way to do it in <code>liftr</code> or
<code>knitr</code>. But R Markdown allow you to pass parameters to your
R Markdown template, please read this tutorial <a href="http://rmarkdown.rstudio.com/developer_parameterized_reports.html" class="external-link">Parameterized
Reports</a>. This doesn’t solve my problem that I want to directly
describe command line interface in the markdown template. However, here
is alternative method:</p>
<p>Create an command line interface to pass <code>params</code> from
docopt into <code><a href="https://pkgs.rstudio.com/rmarkdown/reference/render.html" class="external-link">rmarkdown::render()</a></code> function. In this way, we
can pass as many as possible parameters from command line interface into
our R Markdown template.</p>
<p>So here we go, here is updated methods and it’s also what I use for
another tutorial about RNA-seq workflow.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"docker/sevenbridges/src/"</span>, <span class="st">"runif.R"</span>, package <span class="op">=</span> <span class="st">"sevenbridges"</span><span class="op">)</span></span></code></pre></div>
<p>Here is the current content of command line interface</p>
<pre><code><span><span class="co">#!/usr/local/bin/Rscript</span></span>
<span><span class="st">'usage: runif.R [--n=&lt;int&gt; --min=&lt;float&gt; --max=&lt;float&gt; --seed=&lt;float&gt;]</span></span>
<span><span class="st"></span></span>
<span><span class="st">options:</span></span>
<span><span class="st">--n=&lt;int&gt;        number of observations. If length(n) &gt; 1, the length is taken to be the number required [default: 1].</span></span>
<span><span class="st">--min=&lt;float&gt;   lower limits of the distribution. Must be finite [default: 0].</span></span>
<span><span class="st">--max=&lt;float&gt;   upper limits of the distribution. Must be finite [default: 1].</span></span>
<span><span class="st">--seed=&lt;float&gt;  seed for set.seed() function [default: 1]'</span>  <span class="op">-&gt;</span> <span class="va">doc</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/docopt/docopt.R" class="external-link">"docopt"</a></span><span class="op">)</span></span>
<span><span class="va">opts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/docopt/man/docopt.html" class="external-link">docopt</a></span><span class="op">(</span><span class="va">doc</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create param list</span></span>
<span><span class="va">lst</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">opts</span><span class="op">$</span><span class="va">n</span><span class="op">)</span>,</span>
<span>  min <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">opts</span><span class="op">$</span><span class="va">min</span><span class="op">)</span>,</span>
<span>  max <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">opts</span><span class="op">$</span><span class="va">max</span><span class="op">)</span>,</span>
<span>  seed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">opts</span><span class="op">$</span><span class="va">seed</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># execute your Rmarkdown with these parameters</span></span>
<span><span class="fu">rmarkdown</span><span class="fu">::</span><span class="fu"><a href="https://pkgs.rstudio.com/rmarkdown/reference/render.html" class="external-link">render</a></span><span class="op">(</span><span class="st">"/report/report.Rmd"</span>, <span class="fu">rmarkdown</span><span class="fu">::</span><span class="fu"><a href="https://pkgs.rstudio.com/rmarkdown/reference/html_document.html" class="external-link">html_document</a></span><span class="op">(</span>toc <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, output_dir <span class="op">=</span> <span class="st">"."</span>, params <span class="op">=</span> <span class="va">lst</span><span class="op">)</span></span></code></pre>
<p>And here is the report template</p>
<pre><code>---
title: "Uniform random number generator example"
output:
  rmarkdown::html_document:
    toc: true
    number_sections: true
    css: style.css
params:
  seed: 1
  n: 1
  min: 0
  max: 1
---

## Summary
```{r}
set.seed(params$seed)
r &lt;- runif(
  n = as.integer(params$n),
  min = as.numeric(params$min),
  max = as.numeric(params$max)
)
summary(r)
hist(r)
```</code></pre>
</div>
</div>
<div class="section level2">
<h2 id="setup-docker-hub-automated-build">Setup Docker Hub Automated Build<a class="anchor" aria-label="anchor" href="#setup-docker-hub-automated-build"></a>
</h2>
<p>To make things more reproducible and explicit and automatic, you can
do a autohook to automatically build your container/image on Docker Hub.
Here is what I do</p>
<ol style="list-style-type: decimal">
<li>I created some project called ‘docker’ on my GitHub and it has all
container that crated from a Dockerfile, for example,
tengfei/docker/runif, please go <a href="https://github.com/tengfei/docker/tree/master/runif" class="external-link">here</a> to
check it out</li>
<li>This folder root has a Dockerfile and subfolders for extra materials
I added at build time, like script or report template.</li>
<li>Log into your Docker Hub account, following this <a href="https://docs.docker.com/docker-hub/builds/" class="external-link">tutorial</a> to make
“automated build” from your GitHub account. Make sure you input the
right location for your Dockerfile, by customizing it.</li>
<li>Then you will have auto-build every time you push a new update in
GitHub.</li>
<li>Start using your Docker image like <code>tengfei/runif</code>.</li>
<li>Feel free to push it onto your Seven Bridges platform registry as
well.</li>
</ol>
</div>
<div class="section level2">
<h2 id="more-examples">More Examples<a class="anchor" aria-label="anchor" href="#more-examples"></a>
</h2>
<p>There are more examples under <code>inst/docker</code> folder, you
can check out how to describe command line and build Docker, how to make
report template. You may read the online GitHub <a href="https://github.com/sbg/sevenbridges-r/tree/master/inst/docker" class="external-link">code</a>.
Or you could read another <a href="https://sbg.github.io/sevenbridges-r/articles/bioc-workflow.html" class="external-link">tutorial</a>
about how we wrap RNA-seq workflow from Bioconductor.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Phil Webster, Soner Koc, Nan Xiao, Tengfei Yin, Velsera.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.5.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
